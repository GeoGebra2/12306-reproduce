nodes:
  ROOT:
    type: REQUIREMENT
    name: 12306购票系统
    description: 基于Web的铁路购票系统，包含用户认证、车票查询、预订、订单管理及个人中心等核心功能，首页参考图片：[image](./reference/index.png)。logo资源位于项目根目录的assets/logo.png，在合适的位置引用图片链接。
  REQ-1:
    type: REQUIREMENT
    name: 用户认证模块
    description: 系统的基础设施，提供用户身份识别与管理能力。
  REQ-1-1:
    type: REQUIREMENT
    name: 用户注册
    description: 新用户创建账户，并初始化必要的关联数据。注册表单参考图片：[image](./reference/auth/register.png)
  REQ-1-2:
    type: REQUIREMENT
    name: 用户登录
    description: 验证用户身份并建立会话。登录表单参考图片：[image](./reference/auth/login.png)
  REQ-1-3:
    type: REQUIREMENT
    name: 找回密码流程
    description: 包含填写账号、短信验证、重置密码与完成提示四个页面。
  REQ-1-3-1:
    type: REQUIREMENT
    name: 填写账号页
    description: 输入账号并进入短信验证。
  REQ-1-3-2:
    type: REQUIREMENT
    name: 短信验证页
    description: 输入验证码并进入重置密码。
  REQ-1-3-3:
    type: REQUIREMENT
    name: 重置密码页
    description: 设置新密码并完成重置。
  REQ-1-3-4:
    type: REQUIREMENT
    name: 完成提示页
    description: 展示完成信息并提供去登录入口。
  REQ-2:
    type: REQUIREMENT
    name: 车票查询模块
    description: 查询检索车票。
  REQ-2-1:
    type: REQUIREMENT
    name: 首页快捷查询面板
    description: 快捷查询单程车票，快捷查询面板参考图片：[image](./reference/search/quick_search.png)
  REQ-2-1-1:
    type: REQUIREMENT
    name: 出发地快捷输入
    description: 点击出发地输入框，弹出快捷选择框，支持输入和快捷选择。出发地快捷选择参考图片：[image](./reference/search/quick_address.png)
  REQ-2-1-2:
    type: REQUIREMENT
    name: 目的地快捷输入
    description: 点击目的地输入框，弹出快捷选择框，支持输入和快捷选择。目的地快捷选择参考图片：[image](./reference/search/quick_address.png)
  REQ-2-1-3:
    type: REQUIREMENT
    name: 选择出发日期
    description: 点击出发日期输入框，弹出出发日期选择组件，参考图片：[image](./reference/search/quick_date.png)
  REQ-2-2:
    type: REQUIREMENT
    name: 车次列表页
    description: 展示车次数据，提供查询、筛选功能。参考图片：[image](./reference/search/result.png)
  REQ-2-2-1:
    type: REQUIREMENT
    name: 车票查询条件组件
    description: 位于车票列表页上方的查询框，用于输入查询条件（如出发地、目的地、出发日期）。参考图片：[image](./reference/search/query.png)
  REQ-2-2-2:
    type: REQUIREMENT
    name: 横向筛选组件
    description: 位于车次列表中查询框下方的筛选框，用于根据条件筛选车次。参考图片：[image](./reference/search/filter.png)
  REQ-2-2-3:
    type: REQUIREMENT
    name: 车次数据加载与映射
    description: 核心功能，调用后端接口展示符合筛选条件的车次列表。
  REQ-3:
    type: REQUIREMENT
    name: 个人中心
    description: 管理购票所需的常用数据（如查看个人信息，乘车人、地址等）。参考图片：[image](./reference/center/self.png)
  REQ-3-1:
    type: REQUIREMENT
    name: 查看个人信息
    description: 查看用户基本信息，参考图片：[image](./reference/center/info.png)
  REQ-3-2:
    type: REQUIREMENT
    name: 乘车人管理
    description: 管理账户关联乘车人，参考图片：[image](./reference/center/passenger.png)
  REQ-3-2-1:
    type: REQUIREMENT
    name: 添加乘车人
    description: 添加新的乘车人，添加乘车人表单参考图片：[image](./reference/center/add_passanger.png)
  REQ-3-2-2:
    type: REQUIREMENT
    name: 删除乘车人
    description: 删除已添加的乘车人，不能删除账号本人，删除确认框参考图片：[image](./reference/center/delete_passanger.png)
  REQ-3-3:
    type: REQUIREMENT
    name: 常用地址管理
    description: 管理收货地址（用于餐饮与其它服务）。
  REQ-4:
    type: REQUIREMENT
    name: 订单管理模块
    description: 核心业务流程，预订车次，生成订单；查看、取消和支付订单。
  REQ-4-1:
    type: REQUIREMENT
    name: 订单管理页
    description: 查看订单列表框架。参考图片：[image](./reference/order/orders.png)
  REQ-4-2:
    type: REQUIREMENT
    name: 预订车次
    description: 车次列表页点击预订，跳转到订单填写页，生成订单，订单填写页参考图片：[image](./reference/order/book.png)
  REQ-4-3:
    type: REQUIREMENT
    name: 取消订单
    description: 在未完成订单管理页，点击未完成订单的“取消订单”按钮，删除订单，参考图片：[image](./reference/order/cancel.png)
  REQ-4-4:
    type: REQUIREMENT
    name: 支付订单
    description: 在未完成订单管理页，点击未完成订单的“支付订单”按钮，跳转到支付页，参考图片：[image](./reference/order/pay.png)
  REQ-4-5:
    type: REQUIREMENT
    name: 订单详情页
    description: 展示订单详细信息，支持继续支付、退票、改签等操作。
  REQ-4-6:
    type: REQUIREMENT
    name: 退票成功页
    description: 展示退票成功结果及摘要信息。
  REQ-5:
    type: REQUIREMENT
    name: 餐饮服务模块
    description: 餐饮相关页面与订餐流程的UI与交互。
  REQ-5-1:
    type: REQUIREMENT
    name: 餐饮服务首页
    description: 展示餐饮服务入口与品牌信息。
  REQ-5-2:
    type: REQUIREMENT
    name: 订餐预订页面
    description: 展示自营冷链餐与品牌列表并支持下单。
  REQ-5-3:
    type: REQUIREMENT
    name: 品牌详情页面
    description: 展示品牌Logo与商品列表。
  UI-ROOT:
    type: UI
    path: frontend/src/App.jsx
    description: Root Application Component
  UI-HOME:
    type: UI
    path: frontend/src/pages/HomePage.jsx
    description: Home Page Component
  UI-HEADER-BRAND-SEARCH:
    type: UI
    path: frontend/src/components/HeaderBrandSearch.jsx
    description: Header component with Login/Register links
  UI-LOGIN-PAGE:
    type: UI
    path: frontend/src/pages/LoginPage.jsx
    description: Login Page Skeleton
  UI-REGISTER-PAGE:
    type: UI
    path: frontend/src/pages/RegisterPage.jsx
    description: Register Page Skeleton
  API-USERS-REGISTER:
    type: FUNC
    path: backend/src/routes/users.js
    signature: POST /api/users/register
    db_tables:
      - users
  API-USERS-LOGIN:
    type: FUNC
    path: backend/src/routes/users.js
    signature: POST /api/users/login
    db_tables:
      - users
  FUNC-USER-CHECK-EXISTS:
    type: FUNC
    path: backend/src/controllers/userController.js
    signature: exports.checkUserExists
    db_tables:
      - users
  FUNC-USER-VERIFY-CODE:
    type: FUNC
    path: backend/src/controllers/userController.js
    signature: exports.verifyCode
    db_tables: []
  FUNC-USER-RESET-PASSWORD:
    type: FUNC
    path: backend/src/controllers/userController.js
    signature: exports.resetPassword
    db_tables:
      - users
  API-USER-CHECK-EXISTS:
    type: API
    path: /api/users/forgot/check-user
    signature: POST /api/users/forgot/check-user
  API-USER-VERIFY-CODE:
    type: API
    path: /api/users/forgot/verify-code
    signature: POST /api/users/forgot/verify-code
  API-USER-RESET-PASSWORD:
    type: API
    path: /api/users/forgot/reset-password
    signature: POST /api/users/forgot/reset-password
  UI-FORGOT-PASSWORD-PAGE:
    type: UI
    path: frontend/src/pages/ForgotPasswordPage.jsx
    description: User forgot password flow page with 4 steps
  UI-BOOKING-FORM-DEPARTURE:
    type: UI
    path: frontend/src/components/BookingForm.jsx
    description: Booking form with departure station autocomplete and hot stations
  UI-BOOKING-FORM-DESTINATION:
    type: UI
    path: frontend/src/components/BookingForm.jsx
    description: Booking Form with Destination Station Quick Input and Autocomplete
  UI-BOOKING-FORM-DATE:
    type: UI
    path: frontend/src/components/BookingForm.jsx
    description: Booking Form with Departure Date Selection
  API-STATIONS-SEARCH:
    type: API
    path: backend/src/routes/stations.js
    signature: GET /api/stations?q={query}
  UI-SEARCH-FILTER:
    type: UI
    path: frontend/src/components/TrainList/SearchFilter.jsx
    description: Search Filter Component on Train List Page (From/To/Date inputs with autocomplete)
  UI-PROFILE-INFO:
    type: UI
    path: frontend/src/components/Profile/ProfileInfo.jsx
    description: Profile Info Component displaying user details
  API-USER-PROFILE:
    type: API
    path: backend/src/routes/users.js
    signature: GET /api/users/profile
  FUNC-GET-USER-PROFILE:
    type: FUNC
    path: backend/src/controllers/userController.js
    signature: exports.getUserProfile
    db_tables:
      - users
  UI-PROFILE-PAGE:
    type: UI
    path: frontend/src/pages/ProfilePage.jsx
    description: Profile Page Container with Sub-routes
  UI-PROFILE-LAYOUT:
    type: UI
    path: frontend/src/components/Profile/ProfileLayout.jsx
    description: Profile Layout with Header and Sidebar
  UI-PROFILE-SIDEBAR:
    type: UI
    path: frontend/src/components/Profile/Sidebar.jsx
    description: Profile Sidebar Navigation
  UI-PASSENGER-LIST:
    type: UI
    path: frontend/src/components/Profile/PassengerList.jsx
    description: Passenger List with Add/Delete functionality
  API-PASSENGERS-LIST:
    type: API
    path: backend/src/routes/passengers.js
    signature: GET /api/passengers
  API-PASSENGERS-ADD:
    type: API
    path: backend/src/routes/passengers.js
    signature: POST /api/passengers
  API-PASSENGERS-DELETE:
    type: API
    path: backend/src/routes/passengers.js
    signature: DELETE /api/passengers/:id
  UI-ADDRESS-LIST:
    type: UI
    path: frontend/src/components/Profile/AddressList.jsx
    description: Address management list and form
  API-ADDRESS-LIST:
    type: API
    path: backend/src/routes/address.js
    signature: GET /api/addresses
  API-ADDRESS-ADD:
    type: API
    path: backend/src/routes/address.js
    signature: POST /api/addresses
  API-ADDRESS-DELETE:
    type: API
    path: backend/src/routes/address.js
    signature: DELETE /api/addresses/:id
  AddressList:
    type: UI
    path: frontend/src/components/Profile/AddressList.jsx
    description: Address management list component with add/delete functionality
  GET /api/addresses:
    type: API
    path: backend/src/routes/address.js
    signature: GET /api/addresses
  POST /api/addresses:
    type: API
    path: backend/src/routes/address.js
    signature: POST /api/addresses
  DELETE /api/addresses/:id:
    type: API
    path: backend/src/routes/address.js
    signature: DELETE /api/addresses/:id
  UI-ORDER-LIST:
    type: UI
    path: frontend/src/components/Order/OrderList.jsx
    description: Order Management List with Tabs (Unpaid, Paid, History)
  API-ORDERS-LIST:
    type: API
    path: backend/src/routes/orders.js
    signature: GET /api/orders
  UI-PAY-ORDER-PAGE:
    type: UI
    path: frontend/src/pages/PayOrderPage.jsx
    description: Order Payment Page
  API-ORDERS-GET-DETAIL:
    type: FUNC
    path: backend/src/routes/orders.js
    signature: GET /api/orders/:orderId
    db_tables:
      - orders
      - order_items
  API-ORDERS-PAY:
    type: FUNC
    path: backend/src/routes/orders.js
    signature: POST /api/orders/:orderId/pay
    db_tables:
      - orders
edges:
  - from: ROOT
    to: REQ-1
    relation: HAS_CHILD
  - from: REQ-1
    to: REQ-1-1
    relation: HAS_CHILD
  - from: REQ-1
    to: REQ-1-2
    relation: HAS_CHILD
  - from: REQ-1
    to: REQ-1-3
    relation: HAS_CHILD
  - from: REQ-1-3
    to: REQ-1-3-1
    relation: HAS_CHILD
  - from: REQ-1-3
    to: REQ-1-3-2
    relation: HAS_CHILD
  - from: REQ-1-3
    to: REQ-1-3-3
    relation: HAS_CHILD
  - from: REQ-1-3
    to: REQ-1-3-4
    relation: HAS_CHILD
  - from: ROOT
    to: REQ-2
    relation: HAS_CHILD
  - from: REQ-2
    to: REQ-2-1
    relation: HAS_CHILD
  - from: REQ-2-1
    to: REQ-2-1-1
    relation: HAS_CHILD
  - from: REQ-2-1
    to: REQ-2-1-2
    relation: HAS_CHILD
  - from: REQ-2-1
    to: REQ-2-1-3
    relation: HAS_CHILD
  - from: REQ-2
    to: REQ-2-2
    relation: HAS_CHILD
  - from: REQ-2-2
    to: REQ-2-2-1
    relation: HAS_CHILD
  - from: REQ-2-2
    to: REQ-2-2-2
    relation: HAS_CHILD
  - from: REQ-2-2
    to: REQ-2-2-3
    relation: HAS_CHILD
  - from: ROOT
    to: REQ-3
    relation: HAS_CHILD
  - from: REQ-3
    to: REQ-3-1
    relation: HAS_CHILD
  - from: REQ-3
    to: REQ-3-2
    relation: HAS_CHILD
  - from: REQ-3-2
    to: REQ-3-2-1
    relation: HAS_CHILD
  - from: REQ-3-2
    to: REQ-3-2-2
    relation: HAS_CHILD
  - from: REQ-3
    to: REQ-3-3
    relation: HAS_CHILD
  - from: ROOT
    to: REQ-4
    relation: HAS_CHILD
  - from: REQ-4
    to: REQ-4-1
    relation: HAS_CHILD
  - from: REQ-4
    to: REQ-4-2
    relation: HAS_CHILD
  - from: REQ-4
    to: REQ-4-3
    relation: HAS_CHILD
  - from: REQ-4
    to: REQ-4-4
    relation: HAS_CHILD
  - from: REQ-4
    to: REQ-4-5
    relation: HAS_CHILD
  - from: REQ-4
    to: REQ-4-6
    relation: HAS_CHILD
  - from: ROOT
    to: REQ-5
    relation: HAS_CHILD
  - from: REQ-5
    to: REQ-5-1
    relation: HAS_CHILD
  - from: REQ-5
    to: REQ-5-2
    relation: HAS_CHILD
  - from: REQ-5
    to: REQ-5-3
    relation: HAS_CHILD
  - from: ROOT
    to: UI-ROOT
    relation: DEFINES
  - from: REQ-4-4
    to: UI-PAY-ORDER-PAGE
    relation: DEFINES
  - from: REQ-4-4
    to: API-ORDERS-GET-DETAIL
    relation: DEFINES
  - from: REQ-4-4
    to: API-ORDERS-PAY
    relation: DEFINES
  - from: UI-PAY-ORDER-PAGE
    to: API-ORDERS-GET-DETAIL
    relation: CALLS
  - from: UI-PAY-ORDER-PAGE
    to: API-ORDERS-PAY
    relation: CALLS
  - from: UI-ORDER-LIST
    to: UI-PAY-ORDER-PAGE
    relation: NAVIGATES
  - from: ROOT
    to: UI-HOME
    relation: DEFINES
  - from: UI-HOME
    to: UI-ROOT
    relation: CALLS
  - from: REQ-1
    to: UI-HEADER-BRAND-SEARCH
    relation: DEFINES
  - from: UI-HOME
    to: UI-HEADER-BRAND-SEARCH
    relation: CALLS
  - from: UI-LOGIN-PAGE
    to: UI-HEADER-BRAND-SEARCH
    relation: CALLS
  - from: UI-REGISTER-PAGE
    to: UI-HEADER-BRAND-SEARCH
    relation: CALLS
  - from: REQ-1
    to: UI-LOGIN-PAGE
    relation: DEFINES
  - from: UI-ROOT
    to: UI-LOGIN-PAGE
    relation: CALLS
  - from: REQ-1
    to: UI-REGISTER-PAGE
    relation: DEFINES
  - from: UI-ROOT
    to: UI-REGISTER-PAGE
    relation: CALLS
  - from: REQ-1-1
    to: API-USERS-REGISTER
    relation: DEFINES
  - from: UI-REGISTER-PAGE
    to: API-USERS-REGISTER
    relation: CALLS
  - from: REQ-1-2
    to: API-USERS-LOGIN
    relation: DEFINES
  - from: UI-LOGIN-PAGE
    to: API-USERS-LOGIN
    relation: CALLS
  - from: REQ-1-3
    to: FUNC-USER-CHECK-EXISTS
    relation: DEFINES
  - from: DB-USERS-TABLE
    to: FUNC-USER-CHECK-EXISTS
    relation: CALLS
  - from: REQ-1-3
    to: FUNC-USER-VERIFY-CODE
    relation: DEFINES
  - from: REQ-1-3
    to: FUNC-USER-RESET-PASSWORD
    relation: DEFINES
  - from: DB-USERS-TABLE
    to: FUNC-USER-RESET-PASSWORD
    relation: CALLS
  - from: REQ-1-3
    to: API-USER-CHECK-EXISTS
    relation: DEFINES
  - from: FUNC-USER-CHECK-EXISTS
    to: API-USER-CHECK-EXISTS
    relation: CALLS
  - from: API-USER-CHECK-EXISTS
    to: UI-FORGOT-PASSWORD-PAGE
    relation: CALLS
  - from: REQ-1-3
    to: API-USER-VERIFY-CODE
    relation: DEFINES
  - from: FUNC-USER-VERIFY-CODE
    to: API-USER-VERIFY-CODE
    relation: CALLS
  - from: API-USER-VERIFY-CODE
    to: UI-FORGOT-PASSWORD-PAGE
    relation: CALLS
  - from: REQ-1-3
    to: API-USER-RESET-PASSWORD
    relation: DEFINES
  - from: FUNC-USER-RESET-PASSWORD
    to: API-USER-RESET-PASSWORD
    relation: CALLS
  - from: API-USER-RESET-PASSWORD
    to: UI-FORGOT-PASSWORD-PAGE
    relation: CALLS
  - from: REQ-1-3
    to: UI-FORGOT-PASSWORD-PAGE
    relation: DEFINES
  - from: REQ-2-1-1
    to: UI-BOOKING-FORM-DEPARTURE
    relation: DEFINES
  - from: API-STATIONS-SEARCH
    to: UI-BOOKING-FORM-DEPARTURE
    relation: CALLS
  - from: REQ-2-1-2
    to: UI-BOOKING-FORM-DESTINATION
    relation: DEFINES
  - from: API-STATIONS-SEARCH
    to: UI-BOOKING-FORM-DESTINATION
    relation: CALLS
  - from: REQ-2-1-3
    to: UI-BOOKING-FORM-DATE
    relation: DEFINES
  - from: REQ-2-1-1
    to: API-STATIONS-SEARCH
    relation: DEFINES
  - from: DB-TABLE-STATIONS
    to: API-STATIONS-SEARCH
    relation: CALLS
  - from: UI-BOOKING-FORM-DEPARTURE
    to: UI-ROOT
    relation: CALLS
  - from: REQ-2-2-1
    to: UI-SEARCH-FILTER
    relation: DEFINES
  - from: API-STATIONS-SEARCH
    to: UI-SEARCH-FILTER
    relation: CALLS
  - from: UI-SEARCH-FILTER
    to: UI-TRAIN-LIST-PAGE
    relation: CALLS
  - from: REQ-3-1
    to: UI-PROFILE-INFO
    relation: DEFINES
  - from: UI-PROFILE-PAGE
    to: UI-PROFILE-INFO
    relation: CALLS
  - from: REQ-3-1
    to: API-USER-PROFILE
    relation: DEFINES
  - from: FUNC-GET-USER-PROFILE
    to: API-USER-PROFILE
    relation: CALLS
  - from: API-USER-PROFILE
    to: UI-PROFILE-INFO
    relation: CALLS
  - from: REQ-3-1
    to: FUNC-GET-USER-PROFILE
    relation: DEFINES
  - from: REQ-3
    to: UI-PROFILE-PAGE
    relation: DEFINES
  - from: UI-ROOT
    to: UI-PROFILE-PAGE
    relation: CALLS
  - from: UI-PROFILE-PAGE
    to: UI-PROFILE-LAYOUT
    relation: CALLS
  - from: REQ-3
    to: UI-PROFILE-LAYOUT
    relation: DEFINES
  - from: UI-PROFILE-LAYOUT
    to: UI-PROFILE-SIDEBAR
    relation: CALLS
  - from: REQ-3
    to: UI-PROFILE-SIDEBAR
    relation: DEFINES
  - from: REQ-3-2
    to: UI-PASSENGER-LIST
    relation: DEFINES
  - from: UI-PROFILE-PAGE
    to: UI-PASSENGER-LIST
    relation: CALLS
  - from: UI-PASSENGER-LIST
    to: API-PASSENGERS-LIST
    relation: CALLS
  - from: UI-PASSENGER-LIST
    to: API-PASSENGERS-DELETE
    relation: CALLS
  - from: REQ-3-2
    to: API-PASSENGERS-LIST
    relation: DEFINES
  - from: REQ-3-2
    to: API-PASSENGERS-ADD
    relation: DEFINES
  - from: UI-PASSENGER-LIST
    to: API-PASSENGERS-ADD
    relation: CALLS
  - from: REQ-3-2
    to: API-PASSENGERS-DELETE
    relation: DEFINES
  - from: REQ-3-2-1
    to: API-PASSENGERS-ADD
    relation: DEFINES
  - from: DB-TABLE-PASSENGERS
    to: API-PASSENGERS-ADD
    relation: CALLS
  - from: API-PASSENGERS-ADD
    to: UI-PASSENGER-LIST
    relation: CALLS
  - from: REQ-3-2-1
    to: UI-PASSENGER-LIST
    relation: DEFINES
  - from: REQ-3-3
    to: UI-ADDRESS-LIST
    relation: DEFINES
  - from: REQ-3-3
    to: API-ADDRESS-LIST
    relation: DEFINES
  - from: UI-ADDRESS-LIST
    to: API-ADDRESS-LIST
    relation: CALLS
  - from: REQ-3-3
    to: API-ADDRESS-ADD
    relation: DEFINES
  - from: UI-ADDRESS-LIST
    to: API-ADDRESS-ADD
    relation: CALLS
  - from: REQ-3-3
    to: API-ADDRESS-DELETE
    relation: DEFINES
  - from: UI-ADDRESS-LIST
    to: API-ADDRESS-DELETE
    relation: CALLS
  - from: REQ-3-3
    to: AddressList
    relation: DEFINES
  - from: REQ-3-3
    to: GET /api/addresses
    relation: DEFINES
  - from: REQ-3-3
    to: POST /api/addresses
    relation: DEFINES
  - from: REQ-3-3
    to: DELETE /api/addresses/:id
    relation: DEFINES
  - from: REQ-4-1
    to: UI-ORDER-LIST
    relation: DEFINES
  - from: UI-PROFILE-PAGE
    to: UI-ORDER-LIST
    relation: CALLS
  - from: UI-ORDER-LIST
    to: API-ORDERS-LIST
    relation: CALLS
  - from: REQ-4-1
    to: API-ORDERS-LIST
    relation: DEFINES

